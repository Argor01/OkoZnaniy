# Объяснение: Почему заказ не отображается в ленте

## Проблема
Клиент создал заказ, но не видит его на странице `/orders-feed`.

## Причина
Страница "Лента работ" (`/orders-feed`) предназначена для **экспертов**, чтобы они могли:
- Просматривать доступные заказы
- Брать заказы в работу
- Делать ставки

Endpoint `/api/orders/orders/available/` специально **исключает** заказы самого пользователя:
```python
queryset = self.queryset.filter(
    status='new', 
    expert__isnull=True
).exclude(client=user)  # ← Исключает заказы клиента
```

Это сделано чтобы:
1. Клиент не мог взять свой же заказ в работу
2. Эксперты видели только чужие заказы
3. Не было конфликта интересов

## Решение

### Для клиента
Клиент должен видеть свои заказы в **личном кабинете**:
- Страница: `/client-dashboard` или `/my-orders`
- Endpoint: `/api/users/client_orders/`
- Там отображаются все заказы клиента с их статусами

### Для эксперта
Эксперт видит:
- **Лента работ** (`/orders-feed`) - доступные заказы для взятия в работу
- **Мои заказы** (`/my-orders`) - заказы которые он взял в работу

## Как проверить

### 1. Войти как клиент
```
Роль: client
Страница: /client-dashboard
Видит: Свои созданные заказы
```

### 2. Войти как эксперт
```
Роль: expert
Страница: /orders-feed
Видит: Доступные заказы других клиентов
```

### 3. Проверить API напрямую

**Для клиента - свои заказы:**
```bash
curl -H "Authorization: Bearer $TOKEN" \
  https://okoznaniy.ru/api/users/client_orders/
```

**Для эксперта - доступные заказы:**
```bash
curl -H "Authorization: Bearer $TOKEN" \
  https://okoznaniy.ru/api/orders/orders/available/
```

**Все заказы (для проверки):**
```bash
curl -H "Authorization: Bearer $TOKEN" \
  https://okoznaniy.ru/api/orders/orders/
```

## Структура страниц

```
Клиент:
├── /client-dashboard     → Мои заказы (созданные)
├── /create-order         → Создать новый заказ
└── /order/:id            → Детали заказа

Эксперт:
├── /expert-dashboard     → Личный кабинет
├── /orders-feed          → Лента доступных заказов
├── /my-orders            → Мои заказы (взятые в работу)
└── /order/:id            → Детали заказа

Админ:
├── /admin-dashboard      → Панель управления
└── /orders               → Все заказы системы
```

## Проверка созданного заказа

После создания заказа клиент должен:
1. Перейти в личный кабинет (`/client-dashboard`)
2. Увидеть свой заказ в списке
3. Статус: "Новый" (ожидает эксперта)

Эксперты увидят этот заказ в ленте (`/orders-feed`) и смогут:
- Сделать ставку
- Взять в работу (если клиент примет ставку)

## Логика работы

1. **Клиент создаёт заказ** → Статус: `new`
2. **Заказ появляется в ленте для экспертов** → `/orders-feed`
3. **Эксперты делают ставки** → Клиент видит ставки в своём кабинете
4. **Клиент принимает ставку** → Заказ назначается эксперту
5. **Эксперт выполняет работу** → Статус: `in_progress`
6. **Эксперт отправляет на проверку** → Статус: `review`
7. **Клиент принимает работу** → Статус: `completed`

## Если нужно чтобы клиент видел заказ в ленте

Это **не рекомендуется**, но если очень нужно:

1. Изменить фильтр в `OrderViewSet.available()`:
```python
# Было:
queryset = self.queryset.filter(
    status='new', 
    expert__isnull=True
).exclude(client=user)

# Стало (показывать всем):
queryset = self.queryset.filter(
    status='new', 
    expert__isnull=True
)
```

2. Добавить визуальное отличие для своих заказов:
```typescript
// В OrdersFeed/index.tsx
const isMyOrder = order.client.id === currentUser.id;
```

3. Запретить клиенту брать свой заказ (уже есть проверка в бэкенде)

## Итог

✅ **Заказ создан успешно** - это видно в логах  
✅ **Заказ в статусе "new"** - правильно  
✅ **Заказ не отображается клиенту в ленте** - это **правильное поведение**  
✅ **Заказ отображается экспертам в ленте** - нужно проверить войдя как эксперт  

**Клиент должен смотреть свои заказы в личном кабинете, а не в ленте!**
